# WireGuard Manager

WireGuard VPNã‚µãƒ¼ãƒãƒ¼ã‚’ç°¡å˜ã«ç®¡ç†ã™ã‚‹ãŸã‚ã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚ã‚µãƒ¼ãƒãƒ¼ã®åˆæœŸåŒ–ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è¿½åŠ ãƒ»å‰Šé™¤ã€QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆãªã©ã®æ©Ÿèƒ½ã‚’å‚™ãˆã¦ã„ã¾ã™ã€‚

## ç‰¹å¾´

- ğŸš€ **ç°¡å˜ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**: ä¸»è¦ãªLinuxãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã«å¯¾å¿œ
- ğŸ”’ **ã‚¹ãƒ—ãƒªãƒƒãƒˆãƒˆãƒ³ãƒãƒªãƒ³ã‚°**: æŒ‡å®šã—ãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã¿ã‚’VPNçµŒç”±ã§ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- ğŸ“± **QRã‚³ãƒ¼ãƒ‰å¯¾å¿œ**: ãƒ¢ãƒã‚¤ãƒ«ãƒ‡ãƒã‚¤ã‚¹ã§ã®è¨­å®šãŒç°¡å˜
- ğŸ’¾ **è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: æ—¢å­˜è¨­å®šã®å®‰å…¨ãªãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- ğŸ›¡ï¸ **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é‡è¦–**: é©åˆ‡ãªæ¨©é™è¨­å®šã¨ã‚­ãƒ¼ç®¡ç†
- ğŸ”„ **å‹•çš„åæ˜ **: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¿½åŠ æ™‚ã®å³æ™‚åæ˜ 

## å‰ææ¡ä»¶

- **OS**: Linux (Ubuntu, Debian, CentOS, Fedora, Arch Linux, openSUSE)
- **æ¨©é™**: rootæ¨©é™ï¼ˆsudoï¼‰
- **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶š**: ã‚µãƒ¼ãƒãƒ¼ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«IPå–å¾—ç”¨

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
git clone https://github.com/your-username/wireguard_manager.git
cd wireguard_manager
chmod +x wireguard_manager.sh
```

## ä½¿ç”¨æ–¹æ³•

### 1. WireGuardã‚µãƒ¼ãƒãƒ¼ã®åˆæœŸåŒ–

```bash
sudo ./wireguard_manager.sh init [ãƒãƒ¼ãƒˆç•ªå·]
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh init 51820
```

- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ: 54321
- ãƒãƒ¼ãƒˆç•ªå·ã‚’æŒ‡å®šã—ãªã„å ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆãŒä½¿ç”¨ã•ã‚Œã¾ã™

### 2. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è¿½åŠ 

```bash
sudo ./wireguard_manager.sh add <ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå> <VPN-IPç•ªå·> [è¨±å¯IP]
```

**ä¾‹:**
```bash
# åŸºæœ¬çš„ãªè¿½åŠ ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨±å¯IPã‚’ä½¿ç”¨ï¼‰
sudo ./wireguard_manager.sh add client1 10

# ã‚«ã‚¹ã‚¿ãƒ ã®è¨±å¯IPã‚’æŒ‡å®š
sudo ./wireguard_manager.sh add client2 20 "10.0.0.0/16,172.31.0.0/20"
```

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¬æ˜:**
- `<ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå>`: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ä¸€æ„ãªåå‰
- `<VPN-IPç•ªå·>`: 1-254ã®æ•°å­—ï¼ˆVPNå†…ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹: 10.1.0.Xï¼‰
- `[è¨±å¯IP]`: VPNçµŒç”±ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 10.1.0.0/24,192.168.1.0/24ï¼‰

### 3. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®å‰Šé™¤

```bash
sudo ./wireguard_manager.sh del <ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå>
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh del client1
```

### 4. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆä¸€è¦§ã®è¡¨ç¤º

```bash
sudo ./wireguard_manager.sh list
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh list
```

**è¡¨ç¤ºå†…å®¹:**
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå
- VPN IPã‚¢ãƒ‰ãƒ¬ã‚¹
- ğŸŸ¢/ğŸ”´ æœ‰åŠ¹/ç„¡åŠ¹çŠ¶æ…‹
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æœ‰ç„¡
- QRã‚³ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ‰ç„¡
- éµãƒ•ã‚¡ã‚¤ãƒ«ã®æœ‰ç„¡
- ç·ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæ•°

### 5. æ¥ç¶šä¸­ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ä¸€è¦§è¡¨ç¤º

```bash
sudo ./wireguard_manager.sh connected
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh connected
```

**è¡¨ç¤ºå†…å®¹:**
- æ¥ç¶šä¸­ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå
- ğŸŒ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆæ¥ç¶šå…ƒIP:ãƒãƒ¼ãƒˆï¼‰
- â° æœ€çµ‚ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯æ™‚é–“
- ğŸ“Š ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯æƒ…å ±ï¼ˆé€å—ä¿¡ãƒã‚¤ãƒˆæ•°ï¼‰
- âš™ï¸ è¨­å®šçŠ¶æ…‹ï¼ˆæœ‰åŠ¹/ç„¡åŠ¹ï¼‰
- ğŸŸ¢ æ¥ç¶šçŠ¶æ…‹
- ç™»éŒ²ã•ã‚Œã¦ã„ãªã„ãƒ”ã‚¢ã®è­¦å‘Šè¡¨ç¤º
- æ¥ç¶šä¸­ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæ•°ã¨ç·æ•°ã®ã‚µãƒãƒªãƒ¼

### 6. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®æœ‰åŠ¹åŒ–

```bash
sudo ./wireguard_manager.sh enable <ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå>
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh enable client1
```

### 7. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ç„¡åŠ¹åŒ–

```bash
sudo ./wireguard_manager.sh disable <ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå>
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh disable client1
```

**æ©Ÿèƒ½èª¬æ˜:**
- ç„¡åŠ¹åŒ–ã•ã‚ŒãŸã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯VPNæ¥ç¶šãŒã§ããªããªã‚Šã¾ã™
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯ä¿æŒã•ã‚Œã‚‹ãŸã‚ã€å¾Œã§ç°¡å˜ã«å†æœ‰åŠ¹åŒ–å¯èƒ½
- å³æ™‚åæ˜ ï¼šã‚µãƒ¼ãƒ“ã‚¹å®Ÿè¡Œä¸­ã¯è‡ªå‹•ã§è¨­å®šãŒå†èª­ã¿è¾¼ã¿ã•ã‚Œã¾ã™

### 8. è¨­å®šãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

```bash
sudo ./wireguard_manager.sh validate
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh validate
```

**ãƒã‚§ãƒƒã‚¯é …ç›®:**
- âœ… è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ã¨æ§‹æ–‡ãƒã‚§ãƒƒã‚¯
- âœ… ã‚µãƒ¼ãƒãƒ¼ã‚­ãƒ¼ã®å­˜åœ¨ç¢ºèª
- âœ… IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®é‡è¤‡ãƒã‚§ãƒƒã‚¯
- âœ… ãƒãƒ¼ãƒˆã®ç«¶åˆãƒã‚§ãƒƒã‚¯
- âœ… ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ•´åˆæ€§ç¢ºèª
- âœ… ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šã®ç¢ºèª
- ğŸ“Š ã‚¨ãƒ©ãƒ¼æ•°ã¨è­¦å‘Šæ•°ã®é›†è¨ˆ

### 9. ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

```bash
sudo ./wireguard_manager.sh health
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh health
```

**åŒ…æ‹¬çš„ãªãƒã‚§ãƒƒã‚¯é …ç›®:**
- ğŸ”§ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œè¨¼
- âš™ï¸ ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹ã®ç¢ºèª
- ğŸŒ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹çŠ¶æ…‹ã®ç¢ºèª
- ğŸ“¡ æ¥ç¶šãƒ†ã‚¹ãƒˆã¨ãƒ”ã‚¢çŠ¶æ…‹
- ğŸ“Š ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯çµ±è¨ˆ
- ğŸ“ ãƒ­ã‚°ã‚¨ãƒ©ãƒ¼ã®ç¢ºèª
- ğŸ’» ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ã®ç›£è¦–

### 10. è©³ç´°çµ±è¨ˆæƒ…å ±ã®è¡¨ç¤º

```bash
sudo ./wireguard_manager.sh stats [client-name]
```

**ä¾‹:**
```bash
# å…¨ä½“çµ±è¨ˆã‚’è¡¨ç¤º
sudo ./wireguard_manager.sh stats

# å€‹åˆ¥ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®çµ±è¨ˆã‚’è¡¨ç¤º
sudo ./wireguard_manager.sh stats client1
```

**å…¨ä½“çµ±è¨ˆè¡¨ç¤ºå†…å®¹:**
- ğŸŒ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹æƒ…å ±ï¼ˆIPã€MTUã€ãƒãƒ¼ãƒˆï¼‰
- ğŸ“Š ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯çµ±è¨ˆ
- ğŸ‘¥ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆçµ±è¨ˆã‚µãƒãƒªãƒ¼ï¼ˆæ¥ç¶šæ•°ã€åˆ‡æ–­æ•°ï¼‰
- ğŸ“ˆ ç·ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯é‡ã¨å¹³å‡å€¤
- ğŸ’» ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ï¼ˆç¨¼åƒæ™‚é–“ã€è² è·å¹³å‡ï¼‰

**å€‹åˆ¥çµ±è¨ˆè¡¨ç¤ºå†…å®¹:**
- ğŸ‘¤ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåŸºæœ¬æƒ…å ±
- ğŸ”— æ¥ç¶šçŠ¶æ…‹ã¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- â° æœ€çµ‚ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯ã¨æ¨å®šæ¥ç¶šæ™‚é–“
- ğŸ“Š è©³ç´°ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯æƒ…å ±ï¼ˆå—ä¿¡/é€ä¿¡é‡ã€æ¯”ç‡ï¼‰
- ğŸ“ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®çŠ¶æ…‹

### 11. ãƒ­ã‚°åˆ†æã¨ç›£è¦–

```bash
sudo ./wireguard_manager.sh logs [options]
```

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³:**
```bash
# åŸºæœ¬çš„ãªãƒ­ã‚°è¡¨ç¤º
sudo ./wireguard_manager.sh logs

# æœŸé–“æŒ‡å®šï¼ˆ1h, 24h, 7dï¼‰
sudo ./wireguard_manager.sh logs --since 24h

# ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ãƒ•ã‚£ãƒ«ã‚¿
sudo ./wireguard_manager.sh logs --level error
sudo ./wireguard_manager.sh logs --level warning

# ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæŒ‡å®š
sudo ./wireguard_manager.sh logs --client client1

# ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–
sudo ./wireguard_manager.sh logs --follow

# ãƒ­ã‚°çµ±è¨ˆã‚µãƒãƒªãƒ¼
sudo ./wireguard_manager.sh logs --summary
```

**ä¾‹:**
```bash
# æœ€è¿‘1æ™‚é–“ã®ãƒ­ã‚°ã‚’è¡¨ç¤º
sudo ./wireguard_manager.sh logs

# éå»24æ™‚é–“ã®ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã®ã¿è¡¨ç¤º
sudo ./wireguard_manager.sh logs --since 24h --level error

# client1é–¢é€£ã®ãƒ­ã‚°ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–
sudo ./wireguard_manager.sh logs --client client1 --follow

# ãƒ­ã‚°çµ±è¨ˆã‚’è¡¨ç¤º
sudo ./wireguard_manager.sh logs --summary
```

**ãƒ­ã‚°åˆ†ææ©Ÿèƒ½:**
- ğŸ“Š **ãƒ­ã‚°çµ±è¨ˆ**: ã‚¨ãƒ©ãƒ¼ç‡ã€è­¦å‘Šæ•°ã€ç·ã‚¨ãƒ³ãƒˆãƒªæ•°ã®é›†è¨ˆ
- â° **æ™‚é–“åˆ†æ**: æœ€ã‚‚ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªæ™‚é–“å¸¯ã®ç‰¹å®š
- ğŸš¨ **ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥**: æœ€è¿‘ã®ã‚¨ãƒ©ãƒ¼ã¨è­¦å‘Šã®æŠ½å‡º
- ğŸ‘¥ **æ¥ç¶šã‚¤ãƒ™ãƒ³ãƒˆ**: ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã®è¿½è·¡
- âš¡ **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: ã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹•å›æ•°ã€ãƒ­ã‚°ã‚µã‚¤ã‚ºã®åˆ†æ

### 12. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®šã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

```bash
sudo ./wireguard_manager.sh export <ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå>
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh export client1
```

**ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã•ã‚Œã‚‹å†…å®¹:**
- ğŸ“ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®šãƒ•ã‚¡ã‚¤ãƒ« (.conf)
- ğŸ—ï¸ ç§˜å¯†éµãƒ•ã‚¡ã‚¤ãƒ« (.prv)
- ğŸ”“ å…¬é–‹éµãƒ•ã‚¡ã‚¤ãƒ« (.pub)
- ğŸ“± QRã‚³ãƒ¼ãƒ‰ç”»åƒ (.png)
- ğŸ“‹ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæƒ…å ±ãƒ•ã‚¡ã‚¤ãƒ«
- ğŸŒ ã‚µãƒ¼ãƒãƒ¼è¨­å®šæƒ…å ±

### 13. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®šã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

```bash
sudo ./wireguard_manager.sh import <è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«>
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh import client1.conf
```

**ã‚¤ãƒ³ãƒãƒ¼ãƒˆå‡¦ç†:**
- ğŸ“¥ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œè¨¼
- ğŸ” éµãƒ•ã‚¡ã‚¤ãƒ«ã®æŠ½å‡ºã¨ä¿å­˜
- ğŸ”§ ã‚µãƒ¼ãƒãƒ¼è¨­å®šã¸ã®è¿½åŠ 
- ğŸ“± QRã‚³ãƒ¼ãƒ‰ã®å†ç”Ÿæˆ
- ğŸ”„ è¨­å®šã®å³æ™‚åæ˜ 

### 14. å…¨è¨­å®šã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

```bash
sudo ./wireguard_manager.sh backup
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh backup
```

**ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å¯¾è±¡:**
- ğŸ’» ã‚µãƒ¼ãƒãƒ¼è¨­å®š (/etc/wireguard/)
- ğŸ‘¥ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®š (~/wireguard/)
- ğŸ”‘ å…¨éµãƒ•ã‚¡ã‚¤ãƒ«
- ğŸ“± QRã‚³ãƒ¼ãƒ‰
- ğŸ“Š ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æƒ…å ±

### 15. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ã®å¾©å…ƒ

```bash
sudo ./wireguard_manager.sh restore <ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«>
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh restore wireguard_backup_20241201.tar.gz
```

**å¾©å…ƒå‡¦ç†:**
- ğŸ›¡ï¸ ç·Šæ€¥ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ä½œæˆ
- ğŸ”„ ã‚µãƒ¼ãƒ“ã‚¹ã®åœæ­¢
- ğŸ“‚ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å¾©å…ƒ
- âœ… è¨­å®šæ¤œè¨¼
- ğŸš€ ã‚µãƒ¼ãƒ“ã‚¹ã®å†èµ·å‹•

### 16. ã‚µãƒ¼ãƒ“ã‚¹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ç¢ºèª

```bash
sudo ./wireguard_manager.sh status
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh status
```

**è¡¨ç¤ºå†…å®¹:**
- ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹ï¼ˆå®Ÿè¡Œä¸­/åœæ­¢ä¸­ï¼‰
- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹çŠ¶æ…‹
- æ¥ç¶šä¸­ã®ãƒ”ã‚¢æƒ…å ±
- ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯çµ±è¨ˆ
- æœ€æ–°ã®ãƒ­ã‚°

### 17. ã‚µãƒ¼ãƒ“ã‚¹ã®èµ·å‹•

```bash
sudo ./wireguard_manager.sh start
```

### 18. ã‚µãƒ¼ãƒ“ã‚¹ã®åœæ­¢

```bash
sudo ./wireguard_manager.sh stop
```

### 19. ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒªã‚¹ã‚¿ãƒ¼ãƒˆ

```bash
sudo ./wireguard_manager.sh restart
```

### 20. è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­å®š

```bash
sudo ./wireguard_manager.sh schedule <frequency>
```

**ã‚ªãƒ—ã‚·ãƒ§ãƒ³:**
```bash
# æ¯æ—¥02:00ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
sudo ./wireguard_manager.sh schedule daily

# æ¯é€±æ—¥æ›œæ—¥02:00ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
sudo ./wireguard_manager.sh schedule weekly

# è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ç„¡åŠ¹åŒ–
sudo ./wireguard_manager.sh schedule disable

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®çŠ¶æ…‹ç¢ºèª
sudo ./wireguard_manager.sh schedule status
```

**ä¾‹:**
```bash
# æ¯æ—¥è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’è¨­å®š
sudo ./wireguard_manager.sh schedule daily

# ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«çŠ¶æ…‹ã‚’ç¢ºèª
sudo ./wireguard_manager.sh schedule status
```

**è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ç‰¹å¾´:**
- â° **å®šæœŸå®Ÿè¡Œ**: cronã‚¸ãƒ§ãƒ–ã«ã‚ˆã‚‹è‡ªå‹•åŒ–
- ğŸ§¹ **è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—**: å¤ã„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®è‡ªå‹•å‰Šé™¤
- ğŸ“§ **ã‚µã‚¤ãƒ¬ãƒ³ãƒˆå®Ÿè¡Œ**: ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã®å®Ÿè¡Œ
- ğŸ” **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: é©åˆ‡ãªæ¨©é™è¨­å®š

### 21. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€è¦§è¡¨ç¤º

```bash
sudo ./wireguard_manager.sh backup-list
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh backup-list
```

**è¡¨ç¤ºå†…å®¹:**
- ğŸ“… ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ—¥æ™‚ã¨ãƒ•ã‚¡ã‚¤ãƒ«å
- ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º
- ğŸ“‚ ä¿å­˜å ´æ‰€
- ğŸ“Š ç·æ•°ã¨ä¿å­˜æœŸé–“ã®çµ±è¨ˆ

### 22. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

```bash
sudo ./wireguard_manager.sh backup-cleanup
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh backup-cleanup
```

**ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æˆ¦ç•¥:**
- ğŸ—‚ï¸ **æˆ¦ç•¥1**: 7æ—¥ä»¥ä¸Šå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ï¼ˆæœ€æ–°10å€‹ä¿æŒï¼‰
- ğŸ—‚ï¸ **æˆ¦ç•¥2**: 100å€‹ä»¥ä¸Šã®å ´åˆã€æœ€æ–°50å€‹ã‚’æ®‹ã—ã¦å‰Šé™¤
- ğŸ“Š **ãƒ¬ãƒãƒ¼ãƒˆ**: å‰Šé™¤ãƒ•ã‚¡ã‚¤ãƒ«æ•°ã¨è§£æ”¾å®¹é‡ã®è¡¨ç¤º

### 23. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ã®å¾©å…ƒ

```bash
sudo ./wireguard_manager.sh restore <backup-file>
```

**ä¾‹:**
```bash
sudo ./wireguard_manager.sh restore wireguard_backup_20241201_143052.tar.gz
```

**å¾©å…ƒå‡¦ç†:**
- ğŸ›¡ï¸ ç·Šæ€¥ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ä½œæˆ
- ğŸ”„ ã‚µãƒ¼ãƒ“ã‚¹ã®åœæ­¢
- ğŸ“‚ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å¾©å…ƒ
- âœ… è¨­å®šæ¤œè¨¼
- ğŸš€ ã‚µãƒ¼ãƒ“ã‚¹ã®å†èµ·å‹•

## è¨­å®š

### ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨±å¯IPå¤‰æ›´

ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã® `ALLOWED_IPS` å¤‰æ•°ã‚’ç·¨é›†ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¹ãƒ—ãƒªãƒƒãƒˆãƒˆãƒ³ãƒãƒ«è¨­å®šã‚’å¤‰æ›´ã§ãã¾ã™ã€‚

```bash
# ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã®è¨­å®š
ALLOWED_IPS="10.1.0.0/24,192.168.1.0/24"
```

### ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®š

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯è‡ªå‹•çš„ã«å¿…è¦ãªãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã—ã¾ã™ï¼š

- **nftableså¯¾å¿œ**: ãƒ¢ãƒ€ãƒ³ãªnftablesã‚’å„ªå…ˆä½¿ç”¨
- **iptablesäº’æ›**: nftablesæœªå¯¾å¿œã®å ´åˆã¯iptablesã‚’ä½¿ç”¨
- **NATè¨­å®š**: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ç”¨ã®MASQUERADEãƒ«ãƒ¼ãƒ«
- **ãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°**: VPNã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯è»¢é€

## ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«

```
/etc/wireguard/
â”œâ”€â”€ wg0.conf              # ã‚µãƒ¼ãƒãƒ¼è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ keys/                 # æš—å·éµãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ server.prv/pub    # ã‚µãƒ¼ãƒãƒ¼ã‚­ãƒ¼
â”‚   â””â”€â”€ *.prv/pub         # ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚­ãƒ¼
â””â”€â”€ scripts/              # Up/Downã‚¹ã‚¯ãƒªãƒ—ãƒˆ
    â”œâ”€â”€ wg0-up.sh
    â””â”€â”€ wg0-down.sh

~/wireguard/
â”œâ”€â”€ conf/                 # ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ qrcodes/              # QRã‚³ãƒ¼ãƒ‰ç”»åƒ
â””â”€â”€ backup/               # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ä¸€èˆ¬çš„ãªå•é¡Œ

**Q: "Error: ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ root æ¨©é™ã§å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™"**
- A: `sudo` ã‚’ä½¿ç”¨ã—ã¦å®Ÿè¡Œã—ã¦ãã ã•ã„

**Q: "Error: Unsupported distribution"**
- A: å¯¾å¿œã—ã¦ã„ãªã„ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®å ´åˆã€æ‰‹å‹•ã§ä»¥ä¸‹ã®ãƒ„ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ï¼š
  - wireguard
  - wireguard-tools
  - qrencode
  - curl

**Q: "Error: failed to detect global IPv4 address"**
- A: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹å–å¾—ç”¨ã®APIã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„å ´åˆãŒã‚ã‚Šã¾ã™

**Q: "Error: Invalid CIDR format"**
- A: è¨±å¯IPã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚æ­£ã—ã„å½¢å¼: `x.x.x.x/y` (ä¾‹: `10.0.0.0/16`)

### ã‚µãƒ¼ãƒ“ã‚¹ç®¡ç†

```bash
# ã‚µãƒ¼ãƒ“ã‚¹ã®çŠ¶æ…‹ç¢ºèªï¼ˆè©³ç´°æƒ…å ±è¡¨ç¤ºï¼‰
sudo ./wireguard_manager.sh status

# ã‚µãƒ¼ãƒ“ã‚¹ã®èµ·å‹•
sudo ./wireguard_manager.sh start

# ã‚µãƒ¼ãƒ“ã‚¹ã®åœæ­¢
sudo ./wireguard_manager.sh stop

# ã‚µãƒ¼ãƒ“ã‚¹ã®å†èµ·å‹•
sudo ./wireguard_manager.sh restart

# å¾“æ¥ã®systemctlã‚³ãƒãƒ³ãƒ‰ã‚‚ä½¿ç”¨å¯èƒ½
sudo systemctl status wg-quick@wg0
sudo systemctl stop wg-quick@wg0
sudo systemctl start wg-quick@wg0
sudo systemctl restart wg-quick@wg0
```

### ãƒ­ã‚°ã®ç¢ºèª

```bash
# ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°
sudo journalctl -u wg-quick@wg0

# WireGuardã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹æƒ…å ±
sudo wg show wg0
```

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

- ğŸ” ã™ã¹ã¦ã®ç§˜å¯†éµã¯é©åˆ‡ãªæ¨©é™(600)ã§ä¿å­˜ã•ã‚Œã¾ã™
- ğŸ›¡ï¸ å…¬é–‹éµã®ã¿ãŒã‚µãƒ¼ãƒãƒ¼è¨­å®šã«å«ã¾ã‚Œã¾ã™
- ğŸ”„ å®šæœŸçš„ãªéµã®ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ¨å¥¨ã—ã¾ã™
- ğŸ“Š ãƒ­ã‚°ã«ã¯æ¥ç¶šæƒ…å ±ãŒè¨˜éŒ²ã•ã‚Œã¾ã™

## ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ãƒªã‚¹ãƒˆã‚¢

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯è‡ªå‹•çš„ã«æ—¢å­˜ã®è¨­å®šã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¾ã™ï¼š

- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å ´æ‰€: `~/wireguard_backup/YYYYMMDD-HHMMSS/`
- ãƒªã‚¹ãƒˆã‚¢æ™‚ã¯ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„

## å¯¾å¿œãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

- âœ… Ubuntu/Debian (apt)
- âœ… CentOS/RHEL/Fedora (dnf/yum)
- âœ… Arch Linux (pacman)
- âœ… openSUSE (zypper)
- âŒ ãã®ä»–ã®ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæ‰‹å‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ï¼‰

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ MIT ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

## è²¢çŒ®

1. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ•ã‚©ãƒ¼ã‚¯
2. æ©Ÿèƒ½ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ (`git checkout -b feature/amazing-feature`)
3. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ (`git commit -m 'Add amazing feature'`)
4. ãƒ–ãƒ©ãƒ³ãƒã‚’ãƒ—ãƒƒã‚·ãƒ¥ (`git push origin feature/amazing-feature`)
5. Pull Requestã‚’ä½œæˆ

## ã‚µãƒãƒ¼ãƒˆ

ãƒã‚°å ±å‘Šã‚„æ©Ÿèƒ½ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ GitHub Issues ã‹ã‚‰ãŠé¡˜ã„ã—ã¾ã™ã€‚
